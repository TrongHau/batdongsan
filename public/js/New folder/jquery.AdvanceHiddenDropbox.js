(function(a){function b(c){this.Value=a("#"+c.hddValue);this.divOptions=a("#"+c.id);for(var d in c){this.divOptions.attr(d,c[d])}if(c.minValue!==undefined){this.txtMinValue=a("#"+c.minValue)}else{this.txtMinValue=null}if(c.maxValue!==undefined){this.txtMaxValue=a("#"+c.maxValue)}else{this.txtMaxValue=null}this.lstValue=this.divOptions.children("ul").children();this.selectText=a("#"+c.ddlId).children(".select-text");this.bgIcon=this.selectText.css("background-image");this.textDefault=a(this.lstValue[0]).text();this.valueDefault=a(this.lstValue[0]).attr("vl");if(c.unit!==undefined){this.unitPrice=c.unit}else{this.unitPrice=null}this.lblMin=a("#"+c.lblMin);this.lblMax=a("#"+c.lblMax);return this}AdvanceHiddenDropbox=function(d){var c=a(this);if(c.length==0){return null}d=a.extend(d,{ddlId:c.attr("id")});this.me=new b(d);if(d.css){this.me.divOptions.css(d.css)}this.me.divOptions.children("ul").css("min-width",c.width()+"px");this.me.divOptions.children("ul").children("li").css("min-width",(c.width()-32)+"px");if(this.me.divOptions.children("ul").height()>300){this.me.divOptions.css("width",(c.width()+22)+"px")}if(this.me.divOptions.width()<c.width()){this.me.divOptions.css("width",c.width()+"px")}var j=window.navigator.userAgent;if((d.autocomplete==true||d.id=="divCityOptions"||d.id=="divDistrictOptions"||d.id=="divWardOptions"||d.id=="divStreetOptions"||d.id=="divProjectOptions"||d.id=="divCityCompareOptions"||d.id=="divDistrictCompareOptions"||d.id=="divWardCompareOptions"||d.id=="divStreetCompareOptions"||d.id=="divProjectCompareOptions")&&j.indexOf("MSIE")<0&&j.indexOf("Trident")<0){if(c.attr("enable")!="false"){var i=d.isrequired?" required":"";if(this.me.Value.val().length>0&&d.isallowfreevalue){this.me.selectText.html('<input type="text" class="select-text-content'+i+'" value="'+this.me.Value.val()+'" placeholder="'+this.me.textDefault+'"/>')}else{this.me.selectText.html('<input type="text" class="select-text-content'+i+'" value="'+this.me.textDefault+'" placeholder="'+this.me.textDefault+'"/>')}}}this.me.selectText.children().css("width",(this.me.selectText.width()-25)+"px");this.me.selectText.children(".select-text-content").off("keypress keydown keyup");this.me.selectText.on("click",this,function(k){if(c.attr("enable")=="false"){return}if(a(".advance-select-options:visible").length>=0){a(".advance-select-options:visible").each(function(n,o){var m={hddValue:a(o).attr("hddValue"),id:a(o).attr("id"),minValue:a(o).attr("minValue"),maxValue:a(o).attr("maxValue"),maxValue:a(o).attr("maxValue"),ddlId:a(o).attr("ddlId"),unit:a(o).attr("unit"),lblMin:a(o).attr("lblMin"),lblMax:a(o).attr("lblMax")};k.data.CheckToClose(new b(m))})}k.preventDefault();k.stopPropagation();if(k.data.me.selectText.children("input.select-text-content").length>0){k.data.me.selectText.css("background-image","none");a(this).children().val("");k.data.me.selectText.children().removeAttr("placeholder")}if(k.data.me.divOptions.parent().prop("tagName")!="form"){k.data.me.divOptions.appendTo("form")}if(k.data.me.divOptions.css("display")=="none"){a(this).children().removeAttr("readonly");var l=a(k.data).offset();if(k.data.me.divOptions.css("position")!="fixed"){k.data.me.divOptions.css("top",(l.top+c.height()+2)+"px");k.data.me.divOptions.css("left",l.left+"px")}k.data.me.divOptions.css("display","block");k.data.me.lstValue.removeClass("current");k.data.me.lstValue.show();if(k.data.me.Value.val().length>0&&(k.data.me.txtMaxValue==null||k.data.me.txtMaxValue.val().length==0)&&(k.data.me.txtMinValue==null||k.data.me.txtMinValue.val().length==0)){k.data.me.divOptions.children("ul").children("[vl="+k.data.me.Value.val()+"]").addClass("current")}if(k.data.me.txtMinValue!=null){}a("body").bind("click",k.data,function(m){if(a(m.target).hasClass("advance-options")){m.preventDefault();m.stopPropagation()}else{if(k.data.me.divOptions.css("display")!="none"){m.data.CheckToClose()}}})}else{k.data.me.divOptions.css("display","none");a(this).children().attr("readonly","true");k.data.SetValue()}return a(this)});this.me.selectText.children(".select-text-content").on("focus",function(){var k=a(this);k.data("before",k.val());k.val("");k.css("color","#00f");return k}).on("change",this,function(m){var l=m.data;var k=UnicodeToKoDau(a(this).val()).Trim().toLowerCase();if(k.length>0){a(l.me.lstValue).each(function(){var n=UnicodeToKoDau(a(this).text()).Trim().toLowerCase();if(a(this).attr("vl")==""||a(this).attr("vl")=="0"||a(this).attr("vl")=="CN"||n.indexOf(k)<0){a(this).hide()}else{a(this).show()}})}else{a(l.me.lstValue).show()}}).on("keydown",this,function(m){var k=(m.keyCode?m.keyCode:e.which);if(k==13||k==9){try{var l=m.data.me.divOptions.children("ul").children("li.current:visible");if(l.length==1){l.trigger("click")}else{var s=m.data.me.divOptions.children("ul").children("li:visible");if(s!==undefined&&s.length>0){a(s[0]).trigger("click")}}}catch(n){}if(k==13){m.preventDefault();m.stopPropagation();return false}}else{if(k==40||k==38){var l=m.data.me.divOptions.children("ul").children("li:visible");if(l.length>0){var l=m.data.me.divOptions.children("ul").children("li.current:visible");if(l.length>0){l=a(l[0]);l.removeClass("current");if(k==40){var t=l;while(t.hasClass("advance-options")&&t.next(":not(:visible)").length>0){t=t.next()}if(t.next(":visible").length>0){l=t.next()}}else{if(k==38){var u=l;while(u.hasClass("advance-options")&&u.prev(":not(:visible)").length>0){u=u.prev()}if(u.prev(":visible").length>0){l=u.prev()}}}}else{m.data.me.divOptions.children("ul").children("li").removeClass("current");l=a(m.data.me.divOptions.children("ul").children("li:visible")[0])}if(l!==undefined&&l.length>0){l.addClass("current");a(this).val(l.text().Trim());var q=m.data.me.divOptions.children("ul").children("li:first").outerHeight();var v=m.data.me.divOptions.children("ul").height()-q;var o=l.siblings(":visible").andSelf().index(l);if(k==40){if(m.data.me.divOptions.children("ul").scrollTop()+v<o*q){m.data.me.divOptions.children("ul").scrollTop(o*q-v)}}else{if(m.data.me.divOptions.children("ul").scrollTop()>o*q){m.data.me.divOptions.children("ul").scrollTop(o*q)}}}}else{m.data.me.selectText.trigger("click")}}else{if(k==35){var p=m.data.me.divOptions.children("ul").children("li").length;var q=m.data.me.divOptions.children("ul").children("li:first").outerHeight();m.data.me.divOptions.children("ul").scrollTop(p*q);var r=m.data.me.divOptions.children("ul").children("li");if(r.length>0){a(r).removeClass("current");a(r[r.length-1]).addClass("current")}}else{if(k==36){m.data.me.divOptions.children("ul").scrollTop(0);var r=m.data.me.divOptions.children("ul").children("li");if(r.length>0){a(r).removeClass("current");a(r[0]).addClass("current")}}else{}}}}return true}).on("keyup",function(m){var l=(m.keyCode?m.keyCode:e.which);var k=a(this);if(l==13){m.preventDefault();m.stopPropagation()}else{if(l==9){if(k.val().length==0){k.val(k.data("before"))}}else{if(l!=40&&l!=38){if(k.data("before")!==k.val()){k.data("before",k.val());k.trigger("change")}}}}return true}).on("keypress",function(m){var l=(m.keyCode?m.keyCode:e.which);if(l==13){m.preventDefault();m.stopPropagation()}if(d.isnumberonly){var k=(m.which)?m.which:event.keyCode;if(k>31&&(k<48||k>57)){return false}return true}return true}).on("blur",this,function(k){a(this).css("color","#000")}).on("paste input",function(){var k=a(this);if(k.data("before")!==k.val()){k.data("before",k.val());k.trigger("change")}return k});this.minValue=0;this.maxValue=0;function g(m,n){var k=n.keyCode?n.keyCode:n.which;if(k==13){n.data.CheckToClose();n.preventDefault()}else{var l=a(m).attr("decimal")=="true";var o=numbersonly(m,n,l);if(o==false){n.preventDefault()}}}function h(k,l){l.data.UpdateTextValue();var m=a(k).val();if(a(k).attr("id")==d.minValue){l.data.minValue=parseFloat(m)}else{l.data.maxValue=parseFloat(m)}l.data.me.Value.val("")}if(this.me.txtMinValue!=null){this.me.txtMinValue.bind("keydown",this,function(k){g(this,k)});this.me.txtMinValue.bind("keyup",this,function(k){h(this,k)});this.me.txtMinValue.bind("focus",this,function(k){a(this).attr("placeholder","")});this.me.txtMinValue.bind("blur",this,function(k){a(this).attr("placeholder","từ")})}if(this.me.txtMaxValue!=null){this.me.txtMaxValue.bind("keydown",this,function(k){g(this,k)});this.me.txtMaxValue.bind("keyup",this,function(k){h(this,k)});this.me.txtMaxValue.bind("focus",this,function(k){a(this).attr("placeholder","")});this.me.txtMaxValue.bind("blur",this,function(k){a(this).attr("placeholder","đến")})}this.ShowOptions=function(){this.me.selectText.trigger("click")};this.CheckToClose=function(k){if(k===undefined){k=this.me}if(k.txtMaxValue!=null&&k.txtMinValue!=null&&(k.txtMaxValue.val().length>0||k.txtMinValue.val().length>0)){var m=parseFloat(k.txtMinValue.val());var l=parseFloat(k.txtMaxValue.val());if(l<m){var n=k.txtMaxValue.val();k.txtMaxValue.val(k.txtMinValue.val());k.txtMinValue.val(n)}this.UpdateTextValue(k)}else{this.SetValue(null,k)}k.divOptions.css("display","none");a("body").unbind("click");if(k.selectText.children("input.select-text-content").length>0){k.selectText.css("background-image",k.bgIcon);k.selectText.children().attr("placeholder",k.textDefault)}return true};this.UpdateTextValue=function(k){if(k===undefined){k=this.me}if(k.txtMaxValue!=null&&k.txtMinValue!=null){if(k.txtMinValue.val().length==0&&k.txtMaxValue.val().length==0){this.SetValue(null,k)}else{var l="";var m=false;if(k.unitPrice=="money"){if(k.txtMinValue.val().length>0){var n=GetMoneyText2(parseFloat(k.txtMinValue.val())*1000000);if(k.txtMaxValue.val().length>0){l+=n}else{l+=">= "+n}k.lblMin.text(n);m=true}else{k.lblMin.text("")}if(k.txtMaxValue.val().length>0){var n=GetMoneyText2(parseFloat(k.txtMaxValue.val())*1000000);if(k.txtMinValue.val().length>0){l+=" - "+n}else{l+="< "+n}k.lblMax.text(n);m=true}else{k.lblMax.text("")}}else{if(k.unitPrice=="area"){if(k.txtMinValue.val().length>0){if(k.txtMaxValue.val().length>0){l+=k.txtMinValue.val()}else{l+=">= "+k.txtMinValue.val()}m=true}if(k.txtMaxValue.val().length>0){if(k.txtMinValue.val().length>0){l+=" - "+k.txtMaxValue.val()}else{l+="< "+k.txtMaxValue.val()}m=true}l+=" m2"}}if(m){k.selectText.addClass("hasvalue")}else{k.selectText.removeClass("hasvalue")}if(k.selectText.children()[0].tagName.toLowerCase()=="span"){k.selectText.children().text(l)}else{k.selectText.children().val(l)}}}};this.UpdateOptions=function(k){this.me.divOptions.children("ul").html(k);this.me.lstValue=this.me.divOptions.children("ul").children();this.BindOptionEvent()};this.SetValue=function(p,k){if(k===undefined){k=this.me}var o="";var n=false;if(p!==undefined&&p!=null&&k.divOptions.children("ul").children("[vl="+p+"]").length>0){o=k.divOptions.children("ul").children("[vl="+p+"]").text()}else{if(d.isallowfreevalue){var m=k.selectText.children().val();if(m.length>0){var l=k.divOptions.children("ul").children("[vl="+m+"]");if(l.length==0){o=m;p=m}else{l=l[0];o=l.text();p=l.attr("vl")}}}if(o.length==0){var l;if(k.divOptions.children("ul").children("li.current:visible").length>0){l=a(k.divOptions.children("ul").children("li.current:visible")[0])}else{if(k.divOptions.children("ul").children("li:visible").length>0){l=a(k.divOptions.children("ul").children("li:visible")[0])}else{l=k.divOptions.children("ul").children(":nth-child(1)")}}o=l.text();p=l.attr("vl")}}if(p==k.valueDefault){o=k.textDefault}else{n=true}if(n){k.selectText.addClass("hasvalue")}else{k.selectText.removeClass("hasvalue")}if(k.selectText.children()[0].tagName.toLowerCase()=="span"){k.selectText.children().text(o)}else{k.selectText.children().val(o)}k.Value.val(p);if(k.txtMaxValue!=null){k.txtMaxValue.val("")}if(k.txtMinValue!=null){k.txtMinValue.val("")}};this.GetValue=function(k){if(k===undefined){return this.me.Value.val()}else{var l=this.me.divOptions.children("ul").children("[vl="+this.me.Value.val()+"]");if(l.length>0){return a(l[0]).attr(k)}else{l=this.me.divOptions.children("ul").children(".current");if(l.length>0){return a(l[0]).attr(k)}}}};this.CheckValue=function(k){return this.me.divOptions.children("ul").children("li[vl="+k+"]").length>0};this.GetOptions=function(){var k=[];this.me.divOptions.children("ul").children("li").each(function(){k.push({value:a(this).attr("vl"),text:a(this).text()})});return k};this.GetText=function(){if(this.me.selectText.children()[0].tagName.toLowerCase()=="span"){return a(this.me.selectText.children()[0]).text()}else{return a(this.me.selectText.children()[0]).val()}};this.BindOptionEvent=function(){this.me.lstValue.bind("click",this,function(k){a("body").unbind("click");var m=a(this).attr("vl");var l=m!=k.data.me.valueDefault;k.data.me.Value.val(m);if(k.data.me.txtMinValue!=null&&k.data.me.txtMaxValue!=null){k.data.me.txtMinValue.val("");k.data.me.txtMaxValue.val("");k.data.me.lblMax.text("");k.data.me.lblMin.text("")}if(l){k.data.me.selectText.addClass("hasvalue")}else{k.data.me.selectText.removeClass("hasvalue")}if(k.data.me.selectText.children()[0].tagName.toLowerCase()=="span"){k.data.me.selectText.children().text(a(this).text())}else{k.data.me.selectText.children().val(a(this).text())}k.data.me.divOptions.css("display","none");if(k.data._ChangeFunc!=null){k.data._ChangeFunc(k.data._ChangeFuncScope)}if(k.data.me.selectText.children("input.select-text-content").length>0){k.data.me.selectText.css("background-image",k.data.me.bgIcon);k.data.me.selectText.children().attr("placeholder",k.data.me.textDefault)}})};this._ChangeFunc=null;this._ChangeFuncScope=null;this.BindChangeEvent=function(k,l){this._ChangeFunc=l;this._ChangeFuncScope=k};this._GoNextEventFunc=null;this._GoNextEventScope=null;this.BindTabEvent=function(k,l){this._TabEventFunc=l;this._TabEventScope=k};this.BindOptionEvent();if(this.me.txtMaxValue!=null&&this.me.txtMinValue!=null&&(this.me.txtMaxValue.val().length>0||this.me.txtMinValue.val().length>0)){this.UpdateTextValue()}else{if(this.me.divOptions.children("ul").children(".current").length>0){var f=this.me.divOptions.children("ul").children(".current").attr("vl");this.SetValue(f)}else{if(d.isallowfreevalue){f=this.me.selectText.children().val();this.SetValue(f)}else{var f=this.me.divOptions.children("ul").children(":first").attr("vl");this.SetValue(f)}}}return this};AdvanceHiddenDropbox.getValueById=function(){};a.fn.AdvanceHiddenDropbox=AdvanceHiddenDropbox;a.fn.AdvanceHiddenDropbox.getValueById=AdvanceHiddenDropbox.getValueById}(jQuery));